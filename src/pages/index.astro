---
import BaseLayout from '@layouts/BaseLayout.astro';
import BodyTextContainer from '@components/BodyTextContainer.astro';
import ContactUsButton from '@components/ContactUsButton.astro';
import DeguLogo from '@components/DeguLogo.astro';
import HeaderContainer from '@components/HeaderContainer.astro';
import ImageGallery from '@components/ImageGallery.astro';
import LanguageSwitcher from '@components/LanguageSwitcher.astro';
import MenuCollapsed from '@components/MenuCollapsed.astro';
import MenuExpanded from '@components/MenuExpanded.astro';
import PageDesktop from '@components/PageDesktop.astro';
import PageMobile from '@components/PageMobile.astro';
import PageScrollDesktop from '@components/PageScrollDesktop.astro';
import PageScrollMobile from '@components/PageScrollMobile.astro';
import ScrollHint from '@components/ScrollHint.astro';
import TeamImageContainer from '@components/TeamImageContainer.astro';

import { t } from '@i18n/utils';

import socialMediaHero from '@assets/images/pages/social-media-hero.png';
import productPhotographyHero from '@assets/images/pages/product-photography-hero.png';
import keyVisualsHero from '@assets/images/pages/key-visuals-hero.png';
import socialMediaMobile from '@assets/images/pages/Social media assets - Mobile.png';
import productPhotographyMobile from '@assets/images/pages/Product photography- Mobile.png';
import keyVisualsMobile from '@assets/images/pages/Key Visuals & OOH - Mobile.png';

import teamPhoto from '@assets/images/team/Team image.png';

// Gallery images — social media
import sm01 from '@assets/images/gallery/social-media/social-media-1.png';
import sm02 from '@assets/images/gallery/social-media/social-media-2.png';
import sm03 from '@assets/images/gallery/social-media/social-media-3.png';
import sm04 from '@assets/images/gallery/social-media/social-media-4.png';
import sm05 from '@assets/images/gallery/social-media/social-media-5.png';
import sm06 from '@assets/images/gallery/social-media/social-media-6.png';

// Gallery images — product photography
import pp01 from '@assets/images/gallery/product-photography/product-photography-1.png';
import pp02 from '@assets/images/gallery/product-photography/product-photography-2.png';
import pp03 from '@assets/images/gallery/product-photography/product-photography-3.png';
import pp04 from '@assets/images/gallery/product-photography/product-photography-4.png';
import pp05 from '@assets/images/gallery/product-photography/product-photography-5.png';

// Gallery images — key visuals
import kv01 from '@assets/images/gallery/key-visuals/key-visuals-1.png';
import kv02 from '@assets/images/gallery/key-visuals/key-visuals-2.png';

const locale = 'lt';
const i18n = t(locale);

const socialMediaGalleryImages = [sm01, sm02, sm03, sm04, sm05, sm06].map((src, i) => ({
  src,
  alt: i18n.work.pages.socialMedia.gallery[i],
}));

const productPhotographyGalleryImages = [pp01, pp02, pp03, pp04, pp05].map((src, i) => ({
  src,
  alt: i18n.work.pages.productPhotography.gallery[i],
}));

const keyVisualsGalleryImages = [kv01, kv02].map((src, i) => ({
  src,
  alt: i18n.work.pages.keyVisuals.gallery[i],
}));
---

<BaseLayout title={i18n.meta.title} description={i18n.meta.description} locale={locale}>
  <DeguLogo />
  <LanguageSwitcher currentLocale={locale} />

  <main class="hero">
    <div class="intro-block" data-intro="intro-block">
      <HeaderContainer text={i18n.intro.header1} data-intro="header-degu" />
      <div class="studio-row">
        <HeaderContainer text={i18n.intro.header2} data-intro="header-studio" />
        <BodyTextContainer text={i18n.intro.body} class="intro-body" data-intro="body-text" />
      </div>
    </div>
    <ScrollHint class="scroll-hint-pos" data-intro="scroll-hint" />
    <PageScrollDesktop data-scroll="page-scroll">
      <PageDesktop
        imageSrc={socialMediaHero}
        imageAlt={i18n.work.pages.socialMedia.imageAlt}
        galleryId="social-media"
        loading="eager"
        data-intro="gallery-placeholder"
      />
      <PageDesktop
        imageSrc={productPhotographyHero}
        imageAlt={i18n.work.pages.productPhotography.imageAlt}
        galleryId="product-photography"
      />
      <PageDesktop
        imageSrc={keyVisualsHero}
        imageAlt={i18n.work.pages.keyVisuals.imageAlt}
        galleryId="key-visuals"
      />
    </PageScrollDesktop>
    <PageScrollMobile data-scroll="page-scroll-mobile">
      <PageMobile
        imageSrc={socialMediaHero}
        mobileImageSrc={socialMediaMobile}
        imageAlt={i18n.work.pages.socialMedia.imageAlt}
        galleryId="social-media"
        loading="eager"
        data-intro="gallery-placeholder"
      />
      <PageMobile
        imageSrc={productPhotographyHero}
        mobileImageSrc={productPhotographyMobile}
        imageAlt={i18n.work.pages.productPhotography.imageAlt}
        galleryId="product-photography"
      />
      <PageMobile
        imageSrc={keyVisualsHero}
        mobileImageSrc={keyVisualsMobile}
        imageAlt={i18n.work.pages.keyVisuals.imageAlt}
        galleryId="key-visuals"
      />
    </PageScrollMobile>
  </main>

  <section class="outro" data-section="outro">
    <HeaderContainer text={i18n.outro.header1} class="outro-header outro-drop-us" data-outro="header1" />
    <TeamImageContainer
      imageSrc={teamPhoto}
      imageAlt={i18n.outro.teamImageAlt}
      class="outro-team-image"
      data-outro="team-image"
    />
    <div class="outro-right">
      <HeaderContainer text={i18n.outro.header2} class="outro-header outro-a-line" data-outro="header2" />
      <div class="outro-content">
        <BodyTextContainer text={i18n.outro.body} class="outro-body" data-outro="body" />
        <ContactUsButton
          label={i18n.outro.emailButton}
          feedbackText={i18n.outro.emailCopied}
          data-outro="contact-button"
        />
      </div>
    </div>
  </section>

  <div class="menu-wrapper">
    <MenuCollapsed locale={locale} />
  </div>
  <MenuExpanded activeSection="home" locale={locale} />

  <ImageGallery
    galleryId="social-media"
    images={socialMediaGalleryImages}
    layout={['full', 'pair', 'full', 'pair']}
    closeLabel={i18n.gallery.close}
  />
  <ImageGallery
    galleryId="product-photography"
    images={productPhotographyGalleryImages}
    layout={['full', 'pair', 'pair']}
    closeLabel={i18n.gallery.close}
  />
  <ImageGallery
    galleryId="key-visuals"
    images={keyVisualsGalleryImages}
    layout={['full', 'full']}
    closeLabel={i18n.gallery.close}
  />
</BaseLayout>

<script>
  import { initIntroAnimation } from '@lib/animations/intro';
  import { initGallery } from '@lib/animations/gallery';
  import { initOutroAnimation } from '@lib/animations/outro';
  initIntroAnimation();
  initOutroAnimation();
  initGallery();
</script>

<style>
  .hero {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
    overflow: hidden;
    padding: 32.8vh 2rem 2rem;
  }

  .intro-block {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
  }

  .studio-row {
    display: flex;
    align-items: center;
    gap: clamp(4px, 2vw, 24px);
  }

  .intro-body {
    text-align: left;
  }

  .scroll-hint-pos {
    position: relative;
    z-index: 2;
    margin-top: 20px;
  }

  .menu-wrapper {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 100;
    opacity: 0;
    pointer-events: none;
  }

  .hero :global(.page-scroll-desktop),
  .hero :global(.page-scroll-mobile) {
    position: absolute;
    inset: 0;
    z-index: 1;
    overflow: hidden;
    visibility: hidden;
  }

  @media (max-width: 768px) {
    .hero :global(.page-scroll-desktop) {
      display: none;
    }
  }

  @media (min-width: 769px) {
    .hero :global(.page-scroll-mobile) {
      display: none;
    }
  }

  [data-intro="intro-block"],
  [data-intro="scroll-hint"] {
    visibility: hidden;
  }

  @media (max-width: 768px) {
    .hero {
      padding: 32.8vh 1rem 2rem;
    }
  }

  /* ===== Outro Section ===== */
  /* Full height from the start so ScrollTrigger measures the document
     correctly. Kept invisible until initOutroAnimation() sets visibility
     and animates children in. overflow:hidden clips elements that start
     off-screen during their slide-in entrance. */
  .outro {
    position: relative;
    width: 100%;
    height: 100vh;
    background: var(--color-bg);
    overflow: hidden;
    visibility: hidden;
  }

  /* Desktop header sizing — 200px at 1440px = 13.889vw */
  .outro-header :global(.header-text) {
    font-size: 13.889vw;
    line-height: 1;
  }

  /* "DROP US" */
  .outro-drop-us {
    position: absolute;
    left: 12.014%;
    top: 3%;
  }

  /* Team photo — 12px below DROP US bottom.
     DROP US top (3%) + header height (13.889vw at line-height:1) + 12px gap */
  .outro-team-image {
    position: absolute;
    left: 29.097%;
    top: calc(3% + 13.889vw + 12px);
    width: 25.694%;
    aspect-ratio: 370 / 406;
  }

  /* Right block: "A LINE" + body + button — aligned with team image */
  .outro-right {
    position: absolute;
    left: 56.736%;
    top: calc(3% + 13.889vw + 12px);
    width: 31.319%;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .outro-content {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* Override BodyTextContainer scoped styles for outro */
  .outro :global(.body-text-container) {
    max-width: min(280px, 90%);
  }

  .outro :global(.body-text-container p) {
    margin: 0;
    font-size: 16px;
    line-height: 120%;
  }

  @media (max-width: 768px) {
    /* Mobile header sizing — 150px at 390px = 38.462vw */
    .outro-header :global(.header-text) {
      font-size: 38.462vw;
      line-height: 0.907;
    }

    /* "DROP US" wraps to two lines on mobile — Figma: x:22 y:25, 290w on 390x844 */
    .outro-drop-us {
      left: 5.641%;
      top: 2.962%;
      width: 74.359%;
    }

    .outro-drop-us :global(.header-text) {
      white-space: normal;
    }

    /* Team photo — Figma: x:176 y:163, 188x206 on 390x844 */
    .outro-team-image {
      left: 45.128%;
      top: 19.313%;
      width: 48.205%;
      aspect-ratio: 188 / 206;
    }

    /* Right block — Figma: x:26 y:378, 339w on 390x844 */
    .outro-right {
      left: 6.667%;
      top: 44.787%;
      width: 86.923%;
      gap: 8px;
    }

    .outro-a-line :global(.header-text) {
      text-align: right;
    }

    .outro :global(.body-text-container) {
      margin-left: auto;
    }

    .outro :global(.body-text-container p) {
      text-align: right;
    }

    .outro-content {
      align-items: flex-end;
      gap: 17px;
    }
  }
</style>
